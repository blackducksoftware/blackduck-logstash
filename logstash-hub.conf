input {
    beats {
        port => 5044
    }
    log4j {
        mode => server
        host => "0.0.0.0"
        port => 4560
        type => "log4j"
    }
}

output {
    if [category] == "app-log" {
        file {
            path => "/var/lib/logstash/data/%{application}/%{category}/%{+YYYY-MM-dd}.log"
            codec => line { format => "[%{host}] %{[@metadata][raw_message]}" }
            dir_mode => 0775
            file_mode => 0664
        }
    } else {
    	# WIP - This is changing, once all containers are configured, there could be less 'if else' blocks  
    	if [category] {
	        file {
	            codec => line { format => "[%{host}] %{message}" }
	            path => "/var/lib/logstash/data/%{application}/%{category}/%{+YYYY-MM-dd}.log"
	            dir_mode => 0775
	            file_mode => 0664
	        }
        } else {
        	file {
	            codec => line { format => "[%{host}] %{message}" }
	            path => "/var/lib/logstash/data/%{application}/%{+YYYY-MM-dd}.log"
	            dir_mode => 0775
	            file_mode => 0664
	        }
        }
    }
}